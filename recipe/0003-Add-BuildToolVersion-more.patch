From 684ff08f00c62ee6bac48f190fd63d1ca4cdd1b4 Mon Sep 17 00:00:00 2001
From: Ray Donnelly <mingw.android@gmail.com>
Date: Tue, 10 Dec 2019 14:45:58 +0100
Subject: [PATCH 3/3] Add BuildToolVersion more

---
 api/python/MachO/objects/pyBinary.cpp |  9 +++++++++
 include/LIEF/MachO/Binary.hpp         |  7 +++++++
 src/MachO/Binary.cpp                  | 14 ++++++++++++++
 3 files changed, 30 insertions(+)

diff --git a/api/python/MachO/objects/pyBinary.cpp b/api/python/MachO/objects/pyBinary.cpp
index 40dc185..8d03266 100644
--- a/api/python/MachO/objects/pyBinary.cpp
+++ b/api/python/MachO/objects/pyBinary.cpp
@@ -310,6 +310,15 @@ void create<Binary>(py::module& m) {
         "Return binary's " RST_CLASS_REF(lief.MachO.BuildVersion) " if any.",
         py::return_value_policy::reference)
 
+    .def_property_readonly("has_build_tool_version",
+        &Binary::has_build_tool_version,
+        "``True`` if the binary has a " RST_CLASS_REF(lief.MachO.BuildToolVersion) " command",
+        py::return_value_policy::reference_internal)
+
+    .def_property_readonly("build_tool_version",
+        static_cast<no_const_getter<BuildToolVersion&>>(&Binary::build_tool_version),
+        "Return binary's " RST_CLASS_REF(lief.MachO.BuildToolVersion) " if any.",
+        py::return_value_policy::reference)
 
     .def("virtual_address_to_offset",
         &Binary::virtual_address_to_offset,
diff --git a/include/LIEF/MachO/Binary.hpp b/include/LIEF/MachO/Binary.hpp
index 008f057..2fa9b67 100644
--- a/include/LIEF/MachO/Binary.hpp
+++ b/include/LIEF/MachO/Binary.hpp
@@ -428,6 +428,13 @@ class LIEF_API Binary : public LIEF::Binary  {
   BuildVersion&       build_version(void);
   const BuildVersion& build_version(void) const;
 
+  //! ``true`` if the binary has Build Tool Version command.
+  bool has_build_tool_version(void) const;
+
+  //! Return the MachO::BuildToolVersion
+  BuildToolVersion&       build_tool_version(void);
+  const BuildToolVersion& build_tool_version(void) const;
+
   template<class T>
   LIEF_LOCAL bool has_command(void) const;
 
diff --git a/src/MachO/Binary.cpp b/src/MachO/Binary.cpp
index 8757fb2..9fd537f 100644
--- a/src/MachO/Binary.cpp
+++ b/src/MachO/Binary.cpp
@@ -2024,6 +2024,20 @@ const BuildVersion& Binary::build_version(void) const {
   return this->command<BuildVersion>();
 }
 
+// BuildToolVersion command
+// ++++++++++++++++++++++++
+bool Binary::has_build_tool_version(void) const {
+  return this->has_command<BuildToolVersion>();
+}
+
+BuildToolVersion& Binary::build_tool_version(void) {
+  return this->command<BuildToolVersion>();
+}
+
+const BuildToolVersion& Binary::build_tool_version(void) const {
+  return this->command<BuildToolVersion>();
+}
+
 
 LoadCommand& Binary::operator[](LOAD_COMMAND_TYPES type) {
   return this->get(type);
-- 
2.23.0

